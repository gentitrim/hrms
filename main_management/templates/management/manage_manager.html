{% load static %}


<div class="container mt-5" id="manager-list">
  <div class="d-flex justify-content-between mb-3">
    <h2>Manager List</h2>
    <button class="btn btn-outline-secondary mb-5 me-3"
            onclick="window.open('{% url 'create_manager' %}','_self')">Create Manager</button>
  </div>

  <ul class="list-group">


{% for manager in managers %}
      <li class="list-group-item d-flex justify-content-between align-items-center" id="manager-{{ manager.id }}">
        <div>
          <p> {{ manager.user.first_name }}  {{ manager.user.last_name }}  {{ manager.branch }}</p>
        </div>
        <div>
          <button class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#managerdetail"
                  hx-get="{% url 'manager_detail' manager.user.id %}"
                  hx-target="#modal-body"
                  hx-swap="innerHTML">View</button>

          <button class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#editmanager"
                  hx-get="{% url 'edit_manager' manager.user.id %}"
                  hx-target="#modal-body"
                  hx-swap="innerHTML">Edit</button>


                  <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#deletemanager">
                    Delete
                  </button>
                  
                  <!-- Modal delete manager-->
                  <div class="modal fade" id="deletemanager" tabindex="-1" aria-labelledby="deletemanagerLabel" aria-hidden="true">
                    <div class="modal-dialog">
                      <div class="modal-content">
                        <div class="modal-header">
                          <h1 class="modal-title fs-5" id="deletemanagerLabel">Confirm delete of the manager</h1>
                          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                          Are you sure you want to delete this manager?
                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                          <button type="button" class="btn btn-primary" data-bs-dismiss="modal"
                          hx-delete="{% url 'delete_manager' manager.id %}"
                          hx-target="#manager-{{ manager.pk }}"
                          hx-refresh="true"
                          hx-swap="innerHTML"
                          hx-trigger="click"
                          >Confirm</button>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Modal view manager detail -->
                  <div class="modal fade" id="managerdetail" tabindex="-1" aria-labelledby="managerdetailLabel" aria-hidden="true">
                    <div class="modal-dialog">
                      <div class="modal-content">
                        <div class="modal-header">
                          <h1 class="modal-title fs-5" id="managerdetailLabel">Manager Info</h1>
                          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                          <p> {{ manager.user.first_name }}  {{ manager.user.last_name }}  {{ manager.branch }} </p>
                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        </div>
                      </div>
                    </div>
                  </div>


                  <!-- Modal delete manager-->
                  <div class="modal fade" id="edit_manager" tabindex="-1" aria-labelledby="deletemanagerLabel" aria-hidden="true">
                    <div class="modal-dialog">
                      <div class="modal-content">
                        <div class="modal-header">
                          <h1 class="modal-title fs-5" id="deletemanagerLabel">Edit manager</h1>
                          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                          <form method="post">
                            {% csrf_token %}
                            {{ form.non_field_errors }}
                      
                            <div class="mb-3">
                              <label class="form-label">Name</label>
                              {{ form.name }}
                            </div>
                      
                            <div class="mb-3">
                              <label class="form-label">Surname</label>
                              {{ form.surname }}
                            </div>
                      
                            <div class="mb-3">
                              <label class="form-label">Branch</label>
                              {{ form.branch }}
                            </div>
                      
                            <div class="mb-3">
                              <label class="form-label">Role</label>
                              {{ form.role }}
                            </div>
                      
                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                          <button type="button" class="btn btn-primary" data-bs-dismiss="modal"
                          hx-delete="{% url 'delete_manager' manager.id %}"
                          hx-target="#manager-{{ manager.pk }}"
                          hx-swap="innerHTML"
                          hx-trigger="click"
                          >Confirm</button>
                        </div>
                      </div>
                    </div>
                  </div>

        </div>
      </li>
    {% empty %}
      <li class="list-group-item text-center">No managers found.</li>
    {% endfor %}

  </ul>

  <div class="pagination mt-4">
    {% for page_num in page_obj.paginator.page_range %}
      <a href="?page={{ page_num }}" class="btn btn-outline-secondary btn-sm {% if page_obj.number == page_num %}active{% endif %}">
        {{ page_num }}
      </a>
    {% endfor %}
  </div>
</div>

